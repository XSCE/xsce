=============
Portal README
=============

This portal is meant to be shown as a home page when accessing the SchoolServer via a browser from any device
in the network.

It is expected that many implementations will want to customize the portal with respect to the content deployed
on the server and possibly with images that pertain to the implementation.

Accordingly, there are two version of the home page included in XSCE, one in /var/www/html/xs-portal and another
in /var/www/html/home.  Additionally, wordpress or a wiki can serve as the home page.

The variable {{ xsce_home_url }} may be set to the location to which the server should redirect, such as /xs-portal
or /home.

XS-PORTAL
=========

Links to Services
-----------------

The list of available services and their URLs is read from the file named in the ansible var {{ service_filelist }},
which is a .ini style file and is populated by each ansible playbook that installs a service.

The link to a service is generated by a php function which takes the name of the service, e.g. moodle,
and renders a link if that services is listed in {{ service_filelist }} using the passed string for link
text and a longer description.  There is a special function for iiab to allow for the possibility that there
is an appliance on the network rather than an install on the server.  Other special functions may be
needed for future services.

To add a new service create a call to service_link, passing the name of the service as found in the service_filelist
and strings for the link and description.

There is also a php function for links to content that was not installed as a services, such as browsable pdfs, called hard_link.
Look at the various sample index files for how it works.

Localization
-----------------

Support for multiple languages is provided via Multiviews.

The portal will display a page in the XO's language setting if one exists or otherwise in the default language English.
It will also allow the user to select a different language and remember the preference for the session.

To add another language page:

- create index.xx.php, where xx is the code for the language to be supported
- copying index.en.php will be the easiest way to do this

To add another language to or change the list of languages in the menu:

- modify files/xs-portal/incl/banner.html by adding another <li> tag with the code and name of the language
- remove a <li> tag to take a language off the menu

To change the default language modify templates/xs-portal.conf changing the lines:

  DefaultLanguage en

  LanguagePriority en

To add a language not yet encountered modify templates/xs-portal.conf:

- create a line AddLanguage xx .xx where xx is the language code
- add the code to both lists in RewriteRule ^((en|es|hi)/)?(.*?)(\.(html?|php|en|es|hi))
- add a line SetEnvIf REDIRECT_LANG xx prefer-language=xx Header append Vary cookie
- it may be necessary to AddCharset

HOME
====

The index.html page in /home is much simpler in that it does not include multilingual capabilities or sensing
of the presence of content.  However, it will be easier to modify for those familiar with html.

