- include: radius.yml
  when: not xsce_prepped
  tags:
    - radius

- name: ask systemd to reread the unit files, picks up changes done
  shell: systemctl daemon-reload
  when: not installing

- name: Enable radiusd if squid, dansguardian disabled
  service: name=radiusd enabled=yes
  when: (not squid_enabled) and (not dansduardian_enabled)

- name: Enable coova-chilli if squid, dansguardian disabled
  service: name=chilli enabled=yes
  when: (not squid_enabled) and (not dansduardian_enabled)

- name: Disable dhcpd
  service: name=dhcpd enabled=no
  when: (not squid_enabled) and (not dansduardian_enabled)

- name: Stop dhcpd
  service: name=dhcpd state=stopped

- name: Start radiusd
  service: name=radiusd state=started

- name: Start coova-chilli
  service: name=chilli state=started

- name: Restart apache
  service: name=httpd state=restarted
